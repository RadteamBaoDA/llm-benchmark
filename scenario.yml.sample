# LLM Benchmark Scenarios Configuration
# Define multiple benchmark scenarios with different load profiles
#
# ============================================================================
# EXECUTION MODES (Based on JMeter Thread Group Patterns)
# ============================================================================
#
# Basic Modes:
#   - parallel: All requests launched simultaneously (tests max queue pressure)
#   - controlled: Uses semaphore to limit concurrent requests
#   - queue_test: Burst mode to analyze queue behavior (Ollama/vLLM)
#
# JMeter-Style Modes:
#   - ramp_up: Linear ramp-up like JMeter's Thread Group ramp-up period
#       Parameters: ramp_up_time (seconds), ramp_up_steps, hold_time
#
#   - stepping: JMeter Stepping Thread Group pattern
#       Parameters: ramp_up_steps (number of steps), hold_time (per step)
#       Adds users in discrete steps with configurable hold time
#
#   - spike: Spike testing pattern
#       Parameters: spike_multiplier (2.0 = double), spike_duration (seconds)
#       Tests system response to sudden traffic bursts
#
#   - constant_rate: JMeter Constant Throughput Timer pattern
#       Parameters: target_rps (requests per second)
#       Maintains fixed request rate regardless of response time
#
#   - arrivals: JMeter Arrivals Thread Group pattern
#       Parameters: arrival_rate (arrivals per second)
#       Controls arrival rate, allows unlimited concurrent requests
#
#   - ultimate: JMeter Ultimate Thread Group pattern
#       Parameters: stages (list of {start, end, duration})
#       Complex multi-phase load patterns with ramp-up/hold/ramp-down
#
#   - duration: Duration-based execution
#       Parameters: duration_seconds
#       Runs for fixed time, cycling through requests as needed
#
# ============================================================================

scenarios:
  # -------------------------------------------------------------------------
  # BASIC VALIDATION SCENARIOS
  # -------------------------------------------------------------------------
  
  - name: "light_load"
    description: "Light load test for basic validation"
    requests: 50
    concurrency: 5
    warmup_requests: 2
    timeout: 60
    enabled: true
    mode: "controlled"

  - name: "medium_load"
    description: "Medium load test for standard benchmarking"
    requests: 100
    concurrency: 10
    warmup_requests: 3
    timeout: 60
    enabled: true
    mode: "parallel"

  # -------------------------------------------------------------------------
  # JMETER-STYLE RAMP-UP (Thread Group with ramp-up period)
  # -------------------------------------------------------------------------
  
  - name: "jmeter_ramp_up"
    description: "JMeter-style linear ramp-up to target concurrency"
    requests: 200
    concurrency: 40
    warmup_requests: 2
    timeout: 120
    enabled: false
    mode: "ramp_up"
    ramp_up_time: 30.0      # 30 seconds to reach full concurrency
    ramp_up_steps: 10       # 10 steps during ramp-up
    hold_time: 60.0         # Hold at target load for 60 seconds

  # -------------------------------------------------------------------------
  # JMETER STEPPING THREAD GROUP
  # -------------------------------------------------------------------------
  
  - name: "stepping_load"
    description: "JMeter Stepping Thread Group - add users in steps"
    requests: 300
    concurrency: 50
    warmup_requests: 2
    timeout: 120
    enabled: false
    mode: "stepping"
    ramp_up_steps: 5        # 5 steps: +10 users each step
    hold_time: 10.0         # Hold for 10 seconds at each step

  # -------------------------------------------------------------------------
  # SPIKE TESTING
  # -------------------------------------------------------------------------
  
  - name: "spike_test"
    description: "Spike test - sudden burst of traffic"
    requests: 200
    concurrency: 20         # Base concurrency
    warmup_requests: 3
    timeout: 120
    enabled: false
    mode: "spike"
    spike_multiplier: 5.0   # 5x spike (20 -> 100 concurrent)
    spike_duration: 10.0    # Spike lasts 10 seconds

  # -------------------------------------------------------------------------
  # CONSTANT THROUGHPUT (JMeter Constant Throughput Timer)
  # -------------------------------------------------------------------------
  
  - name: "constant_throughput"
    description: "Maintain fixed requests per second rate"
    requests: 300
    concurrency: 30         # Max concurrent requests allowed
    warmup_requests: 3
    timeout: 60
    enabled: false
    mode: "constant_rate"
    target_rps: 10.0        # Target: 10 requests per second

  # -------------------------------------------------------------------------
  # ARRIVALS THREAD GROUP (JMeter Arrivals Thread Group)
  # -------------------------------------------------------------------------
  
  - name: "arrivals_test"
    description: "Control arrival rate, unlimited concurrency"
    requests: 200
    concurrency: 100        # High limit for unbounded arrivals
    warmup_requests: 2
    timeout: 120
    enabled: false
    mode: "arrivals"
    arrival_rate: 20.0      # 20 new requests per second

  # -------------------------------------------------------------------------
  # ULTIMATE THREAD GROUP (JMeter Ultimate Thread Group)
  # -------------------------------------------------------------------------
  
  - name: "ultimate_load_pattern"
    description: "Complex multi-phase load pattern (ramp-up, hold, ramp-down)"
    requests: 500
    concurrency: 50
    warmup_requests: 5
    timeout: 180
    enabled: false
    mode: "ultimate"
    stages:
      - { start: 0, end: 10, duration: 10 }    # Ramp to 10 threads in 10s
      - { start: 10, end: 30, duration: 15 }   # Ramp to 30 threads in 15s
      - { start: 30, end: 50, duration: 10 }   # Ramp to 50 threads in 10s
      - { start: 50, end: 50, duration: 30 }   # Hold at 50 threads for 30s
      - { start: 50, end: 20, duration: 10 }   # Ramp down to 20 threads
      - { start: 20, end: 0, duration: 10 }    # Ramp down to 0 threads

  # -------------------------------------------------------------------------
  # DURATION-BASED TESTING
  # -------------------------------------------------------------------------
  
  - name: "duration_test"
    description: "Run for fixed duration, cycling through requests"
    requests: 100           # Template requests to cycle
    concurrency: 15
    warmup_requests: 3
    timeout: 60
    enabled: false
    mode: "duration"
    duration_seconds: 120.0  # Run for 2 minutes

  # -------------------------------------------------------------------------
  # QUEUE DEPTH TESTING (for Ollama/vLLM/TGI)
  # -------------------------------------------------------------------------
  
  - name: "queue_depth_test"
    description: "Test inference server queue depth and handling"
    requests: 100
    concurrency: 100        # All requests at once
    warmup_requests: 1
    timeout: 180
    enabled: true
    mode: "queue_test"

  # -------------------------------------------------------------------------
  # STRESS TESTING
  # -------------------------------------------------------------------------
  
  - name: "stress_test"
    description: "Stress test with high concurrency"
    requests: 500
    concurrency: 50
    warmup_requests: 5
    timeout: 120
    enabled: true
    mode: "parallel"

  # -------------------------------------------------------------------------
  # ENDURANCE TESTING
  # -------------------------------------------------------------------------
  
  - name: "endurance_test"
    description: "Long-running endurance test"
    requests: 1000
    concurrency: 10
    warmup_requests: 10
    timeout: 300
    enabled: false
    mode: "controlled"

# Default scenario settings (applied if not specified per scenario)
defaults:
  requests: 100
  concurrency: 10
  warmup_requests: 1
  timeout: 60
  enabled: true
  mode: "parallel"
  ramp_up_time: 0.0
  ramp_up_steps: 1
  hold_time: 0.0
  target_rps: 0.0
  spike_multiplier: 2.0
  spike_duration: 5.0
  arrival_rate: 10.0
  duration_seconds: 60.0